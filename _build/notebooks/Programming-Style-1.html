---
redirect_from:
  - "/notebooks/programming-style-1"
interact_link: content/notebooks/Programming-Style-1.ipynb
kernel_name: python3
kernel_path: content/notebooks
has_widgets: false
title: |-
  Programming Style 1
pagenum: 50
prev_page:
  url: /notebooks/programming.html
next_page:
  url: /notebooks/Programming-Style-2.html
suffix: .ipynb
search: variables values python alternative t not same global attribute explicit get object above example code set steel cell pros cons tr block students design context problems objects simple complex different fu inheritance part multiple calculations s just pretty much used overhead list setvars ane though refer physical thickness problem parameters usually etc using change b value expressions well plus scope easy conceptual function bit provide dont manager beginning end also names where maybe programming intended structural able small various quantities tell think material option parts very tension statement attributes required implicit should course those extra into computation mapping variable even

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Programming Style 1</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Programming-Style-1">Programming Style 1<a class="anchor-link" href="#Programming-Style-1"> </a></h2><p>This book is intended to teach 3rd year Civil Engineering students about the design
of structural steel components.</p>
<p>It is not intended to teach Python programming, though it is hoped that eventally
they will be able to make small modifications to the notebooks and see the effect.</p>
<p>This document is an attempt to show alternative Python programming styles, and to compare them.</p>
<p>The base documents from which the students are working will almost
always use single character identifiers to refer to various physical quantities.  Therefore
there will be a lot of overloading.  For example, <em>t</em> is always a thickness, but context will
tell what thickness it is referring to at any particular instant.</p>
<p>I think it important that the Python code mimic this as closely as is practical. 
But the important part is that the Python not get in the way of understanding the engineering.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Problem-Characteristics">Problem Characteristics<a class="anchor-link" href="#Problem-Characteristics"> </a></h3><p>Problems are mostly to compute strengths of specialized physical objects made of structural steel.<br>
These are the general characteristics:</p>
<ul>
<li>The most simple problems will have 5 to 10 parameters (usually single numbers specifying a dimension
of a part, or a material characteristic, or a force, or an option, etc.).  The most complex problems 
may have up to 30 or 40 or so parameters.</li>
<li>In the most complex problems, these parameters may be spread over 5 or 10 different physical parts 
and a couple of different materials.  Multiple parts could have dimensions that are  typically 
referred to using the same name, for example <em>thickness</em>, and denoted using the same symbol, <em>t</em>.</li>
<li>Calculations involve fairly small amounts of logic to calculate each specific quantity. Usually that
logic is easily expressible in only a few lines of Python.</li>
<li>Simple problems may have 5 sets of these calculations; complex problems may have 30 or 40.</li>
<li>The notebook structure is ideal for this, with one calculation set per cell and explanatory
material between.</li>
<li>This is all to support what we call "design" - determining the proper sizes of an object
for structural safety.  In all but the simplest cases, this is a trial and error process: 
guess at a set of parameters, calculate a strength; if not adequate, change something and 
do it all over.</li>
<li>Mostly, the calculations are specified by very specific and precise rules and formulae that 
cover many common cases.  In our case, the document is the 
<a href="https://www.scc.ca/en/standardsdb/standards/27714">CSA S16-14 Design of Steel Structures</a>, 
supplemented with lecture material and other sets of information.</li>
</ul>
<p>Below we will perform one typical set of calculations to determine the tension strength
with respect to a complete fracture of the cross-section (there are other failure modes).
In the vocabulary of the profession, we are determining the '<em>Factored Tension Resistance</em>'
of a bolted tension member</p>
<p>We will show a number of different ways of structuring the Python to do this, and
discuss the relative merits of each.</p>
<p><strong>My favorite is currently Alternative 4b - using the 'with' statement.</strong></p>
<hr>
<hr>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Typical-Data-Definition">Typical Data Definition<a class="anchor-link" href="#Typical-Data-Definition"> </a></h3><p>I think we can agree that we will not use simple global variables to refer to various
physical quantities.  In a more complex problem than shown here, we would have
<code>t1</code>, <code>t2</code>, <code>t3</code> or <code>t_angle</code>, <code>t_gusset</code>, <code>t_plate</code>, etc.
to refer to the various thicknesses.  It becomes unwieldy and makes the code less re-usable.</p>
<p>So the first step is to use normal Python  objects, and use 
attribute values to store the data.  These are essentially just a way of providing multiple
namespaces (i.e., associating a particular value of <em>t</em> with the correct object).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Part</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">doc</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">doc</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kw</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Steel</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span> <span class="s2">&quot;Material for Angles&quot;</span><span class="p">,</span>
            <span class="n">grade</span> <span class="o">=</span> <span class="s2">&quot;CSA G40.21 350W&quot;</span><span class="p">,</span>
            <span class="n">Fy</span> <span class="o">=</span> <span class="mi">350</span><span class="p">,</span>      <span class="c1"># yield strength, MPa = N/mm^2</span>
            <span class="n">Fu</span> <span class="o">=</span> <span class="mi">450</span><span class="p">,</span>      <span class="c1"># ultimate strength, MPa</span>
            <span class="p">)</span>

<span class="n">AngleB7</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span> <span class="s2">&quot;Brace B-7&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="s2">&quot;L152x102x16&quot;</span><span class="p">,</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">152</span><span class="p">,</span>        <span class="c1"># width of longest leg, mm</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">102</span><span class="p">,</span>        <span class="c1"># width of shortest leg</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">15.9</span><span class="p">,</span>       <span class="c1"># thickness</span>
            <span class="n">A</span> <span class="o">=</span> <span class="mi">3780</span><span class="p">,</span>       <span class="c1"># gross cross-sectional area, mm^2</span>
            <span class="n">hd</span> <span class="o">=</span> <span class="mi">24</span><span class="p">,</span>        <span class="c1"># bolt hole diameter allowance</span>
            <span class="n">nbolts</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>     <span class="c1"># number of bolts in direction of load</span>
            <span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="mf">0.9</span>        <span class="c1"># CSA S16-14 13.1</span>
<span class="n">phiu</span> <span class="o">=</span> <span class="mf">0.75</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-1:">Alternative 1:<a class="anchor-link" href="#Alternative-1:"> </a></h3><p>We just refer to attributes of the objects using the normal Python dot notation.
Nothing special.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">An</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">hd</span><span class="o">*</span><span class="n">AngleB7</span><span class="o">.</span><span class="n">t</span>  <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
<span class="k">if</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">nbolts</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>         <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>                <span class="c1">#                        i)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>                <span class="c1">#                        ii)</span>
<span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Steel</span><span class="o">.</span><span class="n">Fu</span>
<span class="n">Tr</span> <span class="o">*</span> <span class="mf">1E-3</span>    <span class="c1"># convert to kN</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>917.5680000000001</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-1u:">Alternative 1u:<a class="anchor-link" href="#Alternative-1u:"> </a></h3><p>Essentially the same as the code above, but use the <code>pint</code> units module to associate units with the
quantities.  This makes it more readable  and explicit for students
and safer (the unit conversions, if required, are explicit) Compare this with the implicit conversion
requiring a comment, above.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pint</span>                  <span class="c1"># setup to use the module for computing with units</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">pint</span><span class="o">.</span><span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">mm</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">[</span><span class="s1">&#39;mm&#39;</span><span class="p">]</span>
<span class="n">kN</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">[</span><span class="s1">&#39;kN&#39;</span><span class="p">]</span>
<span class="n">MPa</span> <span class="o">=</span> <span class="n">ureg</span><span class="p">[</span><span class="s1">&#39;MPa&#39;</span><span class="p">]</span>
<span class="n">ureg</span><span class="o">.</span><span class="n">default_format</span> <span class="o">=</span> <span class="s1">&#39;~P&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Steel</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span> <span class="s2">&quot;Material for Angles&quot;</span><span class="p">,</span>
            <span class="n">grade</span> <span class="o">=</span> <span class="s2">&quot;CSA G40.21 350W&quot;</span><span class="p">,</span>
            <span class="n">Fy</span> <span class="o">=</span> <span class="mi">350</span><span class="o">*</span><span class="n">MPa</span><span class="p">,</span>      <span class="c1"># yield strength</span>
            <span class="n">Fu</span> <span class="o">=</span> <span class="mi">450</span><span class="o">*</span><span class="n">MPa</span><span class="p">,</span>      <span class="c1"># ultimate strength</span>
            <span class="p">)</span>

<span class="n">AngleB7</span> <span class="o">=</span> <span class="n">Part</span><span class="p">(</span> <span class="s2">&quot;Brace B-7&quot;</span><span class="p">,</span>
            <span class="n">size</span> <span class="o">=</span> <span class="s2">&quot;L152x102x16&quot;</span><span class="p">,</span>
            <span class="n">d</span> <span class="o">=</span> <span class="mi">152</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>        <span class="c1"># width of longest leg</span>
            <span class="n">b</span> <span class="o">=</span> <span class="mi">102</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>        <span class="c1"># width of shortest leg</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mf">15.9</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>       <span class="c1"># thickness</span>
            <span class="n">A</span> <span class="o">=</span> <span class="mi">3780</span><span class="o">*</span><span class="n">mm</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>    <span class="c1"># gross cross-sectional area</span>
            <span class="n">hd</span> <span class="o">=</span> <span class="mi">24</span><span class="o">*</span><span class="n">mm</span><span class="p">,</span>        <span class="c1"># bolt hole diameter allowance</span>
            <span class="n">nbolts</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>        <span class="c1"># number of bolts in direction of load</span>
            <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">An</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">A</span> <span class="o">-</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">hd</span><span class="o">*</span><span class="n">AngleB7</span><span class="o">.</span><span class="n">t</span>  <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
<span class="k">if</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">nbolts</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>         <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>                <span class="c1">#                        i)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>                <span class="c1">#                        ii)</span>
<span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Steel</span><span class="o">.</span><span class="n">Fu</span>          <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>bog-standard Python, no additional libraries/concepts required.  Students should be able to 
understand all the Python bits after their first course.</li>
<li>small number of global variables (2, in this case), with smaller chance of them being 
inadvertently stepped on in the notebook.</li>
<li>very explicit.  there is no doubt what part the <em>t</em> belongs to in the first line.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>harder to read with all those extra (and usually extraneous) identifiers in the expressions.<br>
As expressions get more complex, this gets worse.</li>
<li>detracts from re-useability of the code.  If this is copied to serve another part, it
will have to be edited.
Defining functions to do the calculations is problematic as well - see Alternative xx.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-2a:">Alternative 2a:<a class="anchor-link" href="#Alternative-2a:"> </a></h3><p>Extract the required attribute values into global variables at the start of each cell.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ag</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">A</span>
<span class="n">hd</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">hd</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">t</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">AngleB7</span><span class="o">.</span><span class="n">nbolts</span>
<span class="n">Fu</span> <span class="o">=</span> <span class="n">Steel</span><span class="o">.</span><span class="n">Fu</span>

<span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>                <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>                    <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
<span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>              <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>pretty well the same as the above Alternative 1, plus</li>
<li>the actual computation expressions are much more similar to the actual expressions in S16.  For example,
the computation of $T_r$ is specified as '$T_r = \phi_u A_{ne} F_u$' in S16 and expressed in the
code as <code>Tr = phiu*Ane*Fu</code>.  The mapping from one to the other is pretty straightforward.  The code is
much easier to read than in Alternative 1.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>adds quite a few lines of code to each cell - most of it not conceptually very useful (though the
mapping from attribute to variable is useful knowledge for the reader).</li>
<li>this is a biggy -- we have introduced and rely on global variables, even though it is intended that the
scope of most of these (<code>Fu</code> for example) extend only over the one cell.</li>
<li>Global variables are easy to forget.  If we do a computation later that requires a
different <em>t</em> from a different part and if we forget to extract it properly, the wrong
value will be silently used.  <strong>This is deadly</strong>.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-2b:">Alternative 2b:<a class="anchor-link" href="#Alternative-2b:"> </a></h3><p>We can arrange some simple functionality so that the extraction of attributes
to global variables can be done more compactly.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ag</span><span class="p">,</span><span class="n">hd</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s1">&#39;A,hd,t,nbolts&#39;</span><span class="p">,</span><span class="n">AngleB7</span><span class="p">)</span>
<span class="n">Fu</span> <span class="o">=</span> <span class="n">Steel</span><span class="o">.</span><span class="n">Fu</span>

<span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>                <span class="c1"># net x-sect area is gross minus allowance for one hole</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>                    <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
<span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>              <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>pretty well the same as above, plus</li>
<li>fairly compact and explicit extraction of the values needed for this cell.</li>
<li>not a lot of conceptual overhead.  It is pretty easy to learn what the 'get' function
does, and how multiple values are assigned to multiple variables,
so students should be able to work past this with little trouble.</li>
<li>variables can be renamed to better suit the problem (eg 'Ag' vs 'A' and 'n' vs 'nbolts').</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>As above. Global variables are evil when they shouldn't be global.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-2c">Alternative 2c<a class="anchor-link" href="#Alternative-2c"> </a></h3><p>Here we make the <code>get</code> function a bit more complex in order to provide a sort of 'inheritance'.  We can now provide
a list of one or more parts, and these are effectively searched to provide the attribute values.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="o">*</span><span class="n">objs</span><span class="p">):</span>
    <span class="n">_d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">objs</span><span class="p">):</span>   <span class="c1"># reverse order makes leftmost highest priority</span>
        <span class="n">_d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">_d</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The above implementation effectively has the search for each attribute proceeding from left to right.  If an attribute 
is found in more than one object, the leftmost object is used.  I don't know if this is correct.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Ag</span><span class="p">,</span><span class="n">hd</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Fu</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s1">&#39;A,hd,t,nbolts,Fu&#39;</span><span class="p">,</span><span class="n">AngleB7</span><span class="p">,</span><span class="n">Steel</span><span class="p">)</span>

<span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>                <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
<span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>                    <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
<span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>              <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>much the same as the other Alternative 2s, above, plus:</li>
<li>ability to get some inheritance.  For example, <code>Steel</code> is to give the properties of all
angles, except <code>Fu</code> could be transparently over-ridden by <code>AngleB7</code> - a sort of inheritance.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>pretty much the same as Alternative 2a and 2b.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-4a">Alternative 4a<a class="anchor-link" href="#Alternative-4a"> </a></h3><p>Make a context manager that will be executed by the Python <code>with</code> statement.   The 
context manager will inject all attribute values
into the global namespace at the beginning of the block, and undo all those changes
at the end of the block.  Could even make them produce warnings if values are over-ridden
(for example, if <code>t</code> was aleady defined before the beginning of the block) 
(we don't currently do that).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Set_and_Clean</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dct</span><span class="p">,</span><span class="n">parts</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dct</span> <span class="o">=</span> <span class="n">dct</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parts</span> <span class="o">=</span> <span class="n">parts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oldvars</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newvars</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">user_ns</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dct</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">oldvars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">newvars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="n">ns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">ns</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">user_ns</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">oldvars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">newvars</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">ns</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">False</span>

<span class="k">def</span> <span class="nf">setvars</span><span class="p">(</span><span class="o">*</span><span class="n">parts</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
        <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Set_and_Clean</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">parts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">hd</span> <span class="o">=</span> <span class="n">t</span> <span class="o">=</span> <span class="n">nbolts</span> <span class="o">=</span> <span class="n">Fu</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># demo that these will get set properly and unset</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the following, the <code>setvars()</code> function returns a context manager that injects all attribute values
as global variables at the beginning of the block, and removes them and restores previous values at the end.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">setvars</span><span class="p">(</span><span class="n">Steel</span><span class="p">,</span><span class="n">AngleB7</span><span class="p">):</span>
    <span class="n">An</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>             <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
    <span class="k">if</span> <span class="n">nbolts</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>           <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>          <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span><span class="p">,</span><span class="n">hd</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">nbolts</span><span class="p">,</span><span class="n">Fu</span>    <span class="c1"># they were restored back to their original values</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(None, None, None, None, None)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>by far the most compact and least textual overhead.</li>
<li>scope of some variables is limited.  The value of <code>t</code> used in this block disappears at
the end of the block. This may be <strong>HUGELY</strong> good. (Although new variables like <code>Ane</code>
are still permanently injected into the global namespace).</li>
<li>as the objects in the <code>with</code> statement are processed left-to-right, we get
an automatic inheritance mechanism (<code>Angle87</code> over-rides the same named attributes
from <code>Steel</code>).  This can also be a bad thing, of course.  And in this implementation, the rightmost
object 'wins' which is a different precedence from class inheritance.  Though we could change
<code>setvars()</code> to give leftmost objects precence, just like class inheritance.</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>fair bit of conceptual overhead to understanding this.  It is probably 'advanced' Python.
Students will probably not see this in a first course taught to engineers.</li>
<li>cannot rename the variables - must use the attribute names defined in the object (this <em>may</em>
actually be a good thing).</li>
<li>source of values is not explicit.  For example, where does <em>t</em> come from? From reading just this,
you cannot tell whether it is <code>Steel.t</code> or <code>AngleB7.t</code></li>
<li><p><strong>BIG!</strong> With var names being implicit, its far too easy to get the wrong values.  I had:</p>

<pre><code>  with LapPlates,Bolts:
      wn = W - nperline*ha
      Ane = An = wn*T
      Tr = phiu*Ane*Fu          # S16-14: 13.2 a) iii)
      REC(Tr,'Lap Plates, Net Fracture','W,T,ha,wn,phiu,Ane,Fu')

</code></pre>
<p>and <code>Fu</code> was taken from <code>Bolts</code>, whereas it should have been taken from <code>LapPlates</code>.  I guess we need to make the variables explicit for each one.</p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-4b">Alternative 4b<a class="anchor-link" href="#Alternative-4b"> </a></h3><p>In Python, it is usually thought that <a href="https://www.python.org/dev/peps/pep-0020/">Explicit is better than implicit</a>. Lets
change the implementation of setvars to take an explicit list of symbols.  We'll pull out all the stops and
allow explicit renaming and simple expression evaluation.  And also fix the name conflict to use the leftmost.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">setvars2</span><span class="p">(</span><span class="n">names</span><span class="p">,</span><span class="o">*</span><span class="n">parts</span><span class="p">):</span>
    <span class="n">_d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">parts</span><span class="p">):</span>
        <span class="n">_d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">user_ns</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">names</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]:</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">name</span><span class="p">,</span><span class="n">rhs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">rhs</span><span class="p">,</span><span class="n">ns</span><span class="p">,</span><span class="n">_d</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">_d</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>            
            <span class="n">dct</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
    <span class="k">return</span> <span class="n">Set_and_Clean</span><span class="p">(</span><span class="n">dct</span><span class="p">,</span><span class="n">parts</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">setvars2</span><span class="p">(</span><span class="s1">&#39;t,hd,Fu,n=nbolts,Ag=A&#39;</span><span class="p">,</span><span class="n">Steel</span><span class="p">,</span><span class="n">AngleB7</span><span class="p">):</span>
    <span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>         <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>           <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>          <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>about the same as above, plus</li>
<li>variables extracted and set are now explicit at the top of each block, with chance for some error checking</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>tiny bit more complexity / conceptual overhead.  But I think outweighed by clarity and explictness.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Can even have multiple calls to <code>setvars()</code> so you know <em>exactly</em> where each variable comes from.
This will change the precedence order when the same attribute is defined in more than object, but at
least it is explicit.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">setvars2</span><span class="p">(</span><span class="s1">&#39;Fu&#39;</span><span class="p">,</span><span class="n">Steel</span><span class="p">),</span><span class="n">setvars2</span><span class="p">(</span><span class="s1">&#39;t,hd,n=nbolts,Ag=A,N=2&#39;</span><span class="p">,</span><span class="n">AngleB7</span><span class="p">):</span>
    <span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>         <span class="c1"># net x-sect area is gross area minus allowance for one hole</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>           <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span> <span class="o">*</span> <span class="n">N</span>         <span class="c1"># CSA S16-14 13.2 a) iii)</span>
<span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[1835.1360000000002\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative-5">Alternative 5<a class="anchor-link" href="#Alternative-5"> </a></h3><p>Have all computations done in a function, where the parameter list names the local values.  Then you can write a little utility that automatically extracts the values from the objects:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_hide_input">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">inspect</span>

<span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="o">*</span><span class="n">objs</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">_d</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">objs</span><span class="p">):</span>
        <span class="n">_d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="n">argspec</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="p">[(</span><span class="n">arg</span><span class="p">,</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span><span class="n">arg</span><span class="p">))</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">argspec</span><span class="o">.</span><span class="n">args</span><span class="p">]</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">argname</span><span class="p">,</span><span class="n">attrname</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attrname</span> <span class="ow">in</span> <span class="n">_d</span><span class="p">:</span>
            <span class="n">dct</span><span class="p">[</span><span class="n">argname</span><span class="p">]</span> <span class="o">=</span> <span class="n">_d</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">fn</span><span class="p">(</span><span class="o">**</span><span class="n">dct</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">fun1</span><span class="p">(</span><span class="n">Ag</span><span class="p">,</span><span class="n">hd</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Fu</span><span class="o">=</span><span class="mi">350</span><span class="p">):</span>
    <span class="n">An</span> <span class="o">=</span> <span class="n">Ag</span> <span class="o">-</span> <span class="n">hd</span><span class="o">*</span><span class="n">t</span>       <span class="c1"># net x-sect area is gross minus allowance for one hole</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>           <span class="c1"># CSA S16-14 12.3.3.2 b)</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.8</span><span class="o">*</span><span class="n">An</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ane</span> <span class="o">=</span> <span class="mf">0.6</span><span class="o">*</span><span class="n">An</span>
    <span class="n">Tr</span> <span class="o">=</span> <span class="n">phiu</span><span class="o">*</span><span class="n">Ane</span><span class="o">*</span><span class="n">Fu</span>     <span class="c1"># CSA S16-14 13.2 a) iii)</span>
    <span class="k">return</span> <span class="n">Tr</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">kN</span><span class="p">)</span>

<span class="n">call</span><span class="p">(</span><span class="n">fun1</span><span class="p">,</span> <span class="n">Steel</span><span class="p">,</span> <span class="n">AngleB7</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="s1">&#39;nbolts&#39;</span><span class="p">,</span> <span class="n">Ag</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>   <span class="c1"># or something like this</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
\[917.5680000000001\ kN\]
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pros:</strong></p>
<ul>
<li>explicitly limited scope of variables, including newly created ones like <code>Ane</code>.</li>
<li>can nicely provide default values</li>
<li>reasonably easy to remap attribute names ('nbolts' to 'n', for eg).</li>
</ul>
<p><strong>Cons:</strong></p>
<ul>
<li>Not expecially simple - adds a bit of conceptual overhead - perhaps more so than some of the above.</li>
<li>difficult to tell where values come from.  Does 'Fu' come from Steel or AngleB7?</li>
<li>I don't like it.</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-notes">Random notes<a class="anchor-link" href="#Random-notes"> </a></h2><ol>
<li>The problem is in mapping general concepts, like $t$ and <em>thickness</em>, to symbols used in the code, without introducing
too much baggage.</li>
<li>we are really trying to get cell-level scope for certain variables.</li>
<li>or Cell-level namespaces.</li>
<li>I wonder if this could be down with 'magics'?</li>
<li><p>the context manager could interact with the DesignNotes object - maybe make it a method.
Could automatically capture before and after variable values, the 'design var' value,
note any changed variables, including the design var, etc...  Have option to trace variables in addition to those set.
print a trace, etc - just like RECORD ...  I LIKE THIS!!!!!</p>
<div class="highlight"><pre><span></span><span class="n">notes</span> <span class="o">=</span> <span class="n">DesignNotes</span><span class="p">(</span><span class="s1">&#39;Tr&#39;</span><span class="p">,</span><span class="n">trace</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Big Hairy Brace&#39;</span><span class="p">)</span>
 <span class="n">SET</span> <span class="o">=</span> <span class="n">notes</span><span class="o">.</span><span class="n">setvars</span>
 <span class="o">...</span>
 <span class="k">with</span> <span class="n">SET</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">,</span><span class="n">Foo</span><span class="p">,</span><span class="n">Bar</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Bearing Resistance&#39;</span><span class="p">,</span><span class="n">extra</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">):</span>
     <span class="n">Br</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span>
     <span class="n">Tr</span> <span class="o">=</span> <span class="n">Br</span>
</pre></div>
<p>In fact, maybe the design object itself is the context maanager - no need for additional class.
 In fact, maybe this SET method could be used outside a <code>with</code> with slightly reduced functionality.</p>
<p>Could also have a list of symbols that are not initialized at beginning but are removed at end ('<em>Ane</em>' for example).
 Maybe this is the same list as 'extra'?</p>
<p>Also need an option NOT to log anything (sometimes want nested WITH statements so they dont get too long).</p>
</li>
</ol>

</div>
</div>
</div>
</div>

 


    </main>
    